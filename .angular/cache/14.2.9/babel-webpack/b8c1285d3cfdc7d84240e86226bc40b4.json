{"ast":null,"code":"import _classCallCheck from \"/Users/macspok/projects/idempiere-projects/webstore/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"/Users/macspok/projects/idempiere-projects/webstore/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport { Validators } from '@angular/forms';\nimport { ValidationService } from 'src/app/core/services/validation.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/core/services/private.service\";\nimport * as i2 from \"src/app/core/authentication/auth.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"../../../shared/components/control-messages/control-messages.component\";\nimport * as i6 from \"@angular/router\";\n\nfunction UserPasswordComponent_form_12_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r2 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"form\", 13);\n    i0.ɵɵlistener(\"submit\", function UserPasswordComponent_form_12_Template_form_submit_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      var ctx_r1 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r1.save(ctx_r1.passwordForm.value));\n    });\n    i0.ɵɵelementStart(1, \"div\", 0)(2, \"div\", 14)(3, \"h1\", 15)(4, \"span\");\n    i0.ɵɵelement(5, \"i\", 16);\n    i0.ɵɵtext(6, \"Password\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(7, \"div\", 0)(8, \"div\", 17)(9, \"h2\", 18);\n    i0.ɵɵtext(10, \"Password updating\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"p\", 19)(12, \"sup\");\n    i0.ɵɵtext(13, \"*\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(14, \" Mandatory\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(15, \"div\", 20)(16, \"div\", 21)(17, \"label\", 22);\n    i0.ɵɵtext(18, \"Old password\");\n    i0.ɵɵelementStart(19, \"sup\");\n    i0.ɵɵtext(20, \" * \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(21, \"app-control-messages\", 23)(22, \"input\", 24);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(23, \"div\", 21)(24, \"label\", 25);\n    i0.ɵɵtext(25, \"New password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(26, \"app-control-messages\", 23)(27, \"input\", 26);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"div\", 21)(29, \"label\", 27);\n    i0.ɵɵtext(30, \"Confirm password\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(31, \"app-control-messages\", 23)(32, \"input\", 28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(33, \"div\", 14)(34, \"button\", 29);\n    i0.ɵɵelement(35, \"i\", 30);\n    i0.ɵɵtext(36, \"Save\");\n    i0.ɵɵelementEnd()()()()()();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"formGroup\", ctx_r0.passwordForm);\n    i0.ɵɵadvance(21);\n    i0.ɵɵproperty(\"control\", ctx_r0.passwordForm.controls.password);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"control\", ctx_r0.passwordForm.controls.newPassword);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"control\", ctx_r0.passwordForm.controls.confirmPassword);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", !ctx_r0.passwordForm.valid);\n  }\n}\n\nvar _c0 = function _c0() {\n  return [\"/\"];\n};\n\nvar _c1 = function _c1() {\n  return [\"/account\"];\n};\n\nexport var UserPasswordComponent = /*#__PURE__*/(function () {\n  var UserPasswordComponent = /*#__PURE__*/function () {\n    function UserPasswordComponent(privateService, authService, builder) {\n      _classCallCheck(this, UserPasswordComponent);\n\n      this.privateService = privateService;\n      this.authService = authService;\n      this.builder = builder;\n      this.active = true;\n      this.passwordForm = this.builder.group({\n        password: ['', [Validators.required]],\n        newPassword: ['', [Validators.required, ValidationService.passwordValidator]],\n        confirmPassword: ['', Validators.required]\n      }, {\n        validators: [ValidationService.matchingPasswords]\n      });\n    }\n\n    _createClass(UserPasswordComponent, [{\n      key: \"save\",\n      value: function save(password) {\n        var _this = this;\n\n        if (this.passwordForm.dirty && this.passwordForm.valid) {\n          this.privateService.changePassword(password).subscribe(function (resp) {\n            if (!resp.token) {\n              _this.passwordForm.controls['password'].setErrors({\n                invalidOldPassword: true\n              });\n            } else {\n              _this.authService.updateToken(resp);\n\n              _this.authService.showAlert({\n                type: 'success',\n                msg: 'Password updated'\n              });\n\n              password = {};\n\n              _this.passwordForm.reset();\n\n              _this.active = false;\n              setTimeout(function () {\n                return _this.active = true;\n              }, 0);\n            }\n          });\n        }\n      }\n    }]);\n\n    return UserPasswordComponent;\n  }();\n\n  UserPasswordComponent.ɵfac = function UserPasswordComponent_Factory(t) {\n    return new (t || UserPasswordComponent)(i0.ɵɵdirectiveInject(i1.PrivateService), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.FormBuilder));\n  };\n\n  UserPasswordComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: UserPasswordComponent,\n    selectors: [[\"app-user-password\"]],\n    decls: 23,\n    vars: 9,\n    consts: [[1, \"row\"], [1, \"breadcrumbDiv\", \"col-lg-12\"], [1, \"breadcrumb\"], [3, \"routerLink\"], [1, \"active\"], [1, \"container\"], [3, \"formGroup\", \"submit\", 4, \"ngIf\"], [1, \"col-lg-12\", \"my-2\"], [1, \"contentFooter\", \"list-inline\"], [1, \"previous\", \"pull-right\"], [1, \"fa\", \"fa-home\", \"mr-2\"], [1, \"next\", \"pull-left\"], [1, \"fa\", \"fa-arrow-left\", \"mr-2\"], [3, \"formGroup\", \"submit\"], [1, \"col-12\"], [1, \"section-title-inner\"], [1, \"glyphicon\", \"glyphicon-user\", \"vr-2\"], [1, \"col-lg-12\"], [1, \"block-title-2\"], [1, \"required\"], [1, \"col-xs-12\", \"col-sm-6\"], [1, \"form-group\", \"required\"], [\"for\", \"InputPasswordCurrent\"], [3, \"control\"], [\"name\", \"password\", \"formControlName\", \"password\", \"type\", \"password\", \"id\", \"InputPasswordCurrent\", \"autocomplete\", \"foo\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"InputPasswordNew\"], [\"name\", \"newPassword\", \"formControlName\", \"newPassword\", \"type\", \"password\", \"id\", \"InputPasswordNew\", \"autocomplete\", \"foo\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"InputPasswordnewConfirm\"], [\"name\", \"confirmPassword\", \"formControlName\", \"confirmPassword\", \"autocomplete\", \"foo\", \"type\", \"password\", \"id\", \"InputPasswordnewConfirm\", \"required\", \"\", 1, \"form-control\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [1, \"fa\", \"fa-save\", \"mr-2\"]],\n    template: function UserPasswordComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"ul\", 2)(3, \"li\")(4, \"a\", 3);\n        i0.ɵɵtext(5, \"Home\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"li\")(7, \"a\", 3);\n        i0.ɵɵtext(8, \"Account\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(9, \"li\", 4);\n        i0.ɵɵtext(10, \"Password\");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelementStart(11, \"div\", 5);\n        i0.ɵɵtemplate(12, UserPasswordComponent_form_12_Template, 37, 5, \"form\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"div\", 7)(14, \"ul\", 8)(15, \"li\", 9)(16, \"a\", 3);\n        i0.ɵɵelement(17, \"i\", 10);\n        i0.ɵɵtext(18, \" Home\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(19, \"li\", 11)(20, \"a\", 3);\n        i0.ɵɵelement(21, \"i\", 12);\n        i0.ɵɵtext(22, \" Account\");\n        i0.ɵɵelementEnd()()()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(5, _c0));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(6, _c1));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.active);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(7, _c0));\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"routerLink\", i0.ɵɵpureFunction0(8, _c1));\n      }\n    },\n    dependencies: [i4.NgIf, i3.ɵNgNoValidate, i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.RequiredValidator, i3.FormGroupDirective, i3.FormControlName, i5.ControlMessagesComponent, i6.RouterLinkWithHref],\n    encapsulation: 2\n  });\n  return UserPasswordComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}